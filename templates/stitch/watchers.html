{% extends "base.html" %}
{% from 'stitch/_macros.html' import badge, icon_btn %}

{% block title %}Watchers - Email Management Tool{% endblock %}

{% block content %}
<div id="watchers">
<main class="tw-flex-1 tw-px-6 tw-py-4">
        <div class="tw-max-w-7xl tw-mx-auto">
          <div class="tw-flex tw-justify-between tw-items-center tw-mb-4">
            <div>
              <h1 class="tw-text-2xl tw-font-bold tw-text-white">Watchers</h1>
              <p class="tw-text-sm tw-text-zinc-400 tw-mt-1">Monitor and manage IMAP watchers for real-time email interception.</p>
            </div>
            <div class="tw-flex tw-items-center tw-gap-2">
              <button class="tw-text-sm tw-font-medium tw-px-4 tw-py-2 tw-bg-surface tw-text-zinc-300 tw-border tw-border-border tw-hover:bg-zinc-700">
                Validate Counts
              </button>
              <button class="tw-text-sm tw-font-medium tw-px-4 tw-py-2 tw-bg-surface tw-text-zinc-300 tw-border tw-border-border tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-2">
                <span class="material-symbols-outlined tw-text-base">refresh</span>
                Refresh
              </button>
            </div>
          </div>
          <div class="tw-grid tw-grid-cols-1 tw-lg:grid-cols-2 tw-gap-4 tw-mb-4">
            <div class="tw-bg-background tw-p-4 tw-border tw-border-border">
              <div class="tw-flex tw-items-center tw-justify-between tw-mb-4">
                <h3 class="tw-font-semibold tw-text-zinc-300 tw-flex tw-items-center tw-gap-2">
                  SMTP PROXY
                  <span class="material-symbols-outlined tw-text-base tw-text-zinc-500">info</span>
                </h3>
                <div class="tw-flex tw-items-center tw-gap-2 tw-text-sm tw-text-primary tw-font-semibold">
                  <span class="tw-relative tw-flex tw-h-2 tw-w-2">
                    <span class="tw-animate-ping tw-absolute tw-inline-flex tw-h-full tw-w-full tw-bg-primary tw-opacity-75"></span>
                    <span class="tw-relative tw-inline-flex tw-h-2 tw-w-2 tw-bg-primary"></span>
                  </span>
                  Running
                </div>
              </div>
              <p class="tw-text-sm tw-text-zinc-400">127.0.0.1:1087 - Last Check: Oct 24, 01:23 PM</p>
              <button class="tw-mt-4 tw-text-sm tw-font-medium tw-px-4 tw-py-2 tw-bg-zinc-800 tw-text-zinc-300 tw-hover:bg-zinc-700">
                Self-Check
              </button>
            </div>
            <div class="tw-bg-background tw-p-4 tw-border tw-border-border">
              <h3 class="tw-font-semibold tw-text-zinc-300 tw-flex tw-items-center tw-gap-2 tw-mb-2">
                IMAP WATCHERS ACTIVE
                <span class="material-symbols-outlined tw-text-base tw-text-zinc-500">info</span>
              </h3>
              <p class="tw-text-4xl tw-font-bold tw-text-primary">2</p>
              <p class="tw-text-sm tw-text-zinc-400">Across all accounts</p>
            </div>
          </div>
          <div class="tw-mb-4">
            <div class="tw-flex tw-justify-between tw-items-center tw-mb-4">
              <h2 class="tw-text-lg tw-font-bold tw-text-white">Per-Account Watchers</h2>
              <button class="tw-text-sm tw-font-bold tw-px-4 tw-py-2 tw-bg-primary/10 tw-text-primary tw-hover:bg-primary/20 tw-flex tw-items-center tw-gap-2">
                <span class="material-symbols-outlined tw-text-base">restart_alt</span>
                Restart All
              </button>
            </div>
            <div class="tw-grid tw-grid-cols-1 tw-lg:grid-cols-2 tw-gap-4">
              <div class="tw-bg-background tw-p-4 tw-border tw-border-border">
                <div class="tw-mb-4">
                  <p class="tw-text-xs tw-text-zinc-400">GMAIL - NDAYJECHA (PRIMARY TEST)</p>
                  <p class="tw-font-semibold tw-text-zinc-200">ndayjecha@gmail.com</p>
                </div>
                <div class="tw-grid tw-grid-cols-2 tw-gap-4 tw-text-sm tw-mb-4">
                  <div>
                    <p class="tw-text-xs tw-text-zinc-400">State</p>
                    <div class="tw-flex tw-items-center tw-gap-2 tw-font-medium tw-text-primary">
                      <span class="tw-w-2 tw-h-2 tw-bg-primary"></span>
                      Polling
                    </div>
                  </div>
                  <div>
                    <p class="tw-text-xs tw-text-zinc-400">Heartbeat</p>
                    <p class="tw-font-medium tw-text-zinc-300">Oct 24, 04:04 PM</p>
                  </div>
                </div>
                <div class="tw-flex tw-items-center tw-gap-2 tw-pt-4 tw-border-t tw-border-border">
                  <button class="tw-text-xs tw-font-medium tw-px-3 tw-py-1.5 tw-text-zinc-300 tw-bg-surface tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-1.5">
                    <span class="material-symbols-outlined tw-text-sm">play_arrow</span> Start
                  </button>
                  <button class="tw-text-xs tw-font-medium tw-px-3 tw-py-1.5 tw-text-zinc-300 tw-bg-surface tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-1.5">
                    <span class="material-symbols-outlined tw-text-sm">stop</span> Stop
                  </button>
                  <button class="tw-text-xs tw-font-medium tw-px-3 tw-py-1.5 tw-text-zinc-300 tw-bg-surface tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-1.5">
                    <span class="material-symbols-outlined tw-text-sm">restart_alt</span> Restart
                  </button>
                </div>
              </div>
              <div class="tw-bg-background tw-p-4 tw-border tw-border-border">
                <div class="tw-mb-4">
                  <p class="tw-text-xs tw-text-zinc-400">HOSTINGER - OORINBOX (SECONDARY TEST)</p>
                  <p class="tw-font-semibold tw-text-zinc-200">mchtye@oorinbox.com</p>
                </div>
                <div class="tw-grid tw-grid-cols-2 tw-gap-4 tw-text-sm tw-mb-4">
                  <div>
                    <p class="tw-text-xs tw-text-zinc-400">State</p>
                    <div class="tw-flex tw-items-center tw-gap-2 tw-font-medium tw-text-primary">
                      <span class="tw-w-2 tw-h-2 tw-bg-primary"></span>
                      Polling
                    </div>
                  </div>
                  <div>
                    <p class="tw-text-xs tw-text-zinc-400">Heartbeat</p>
                    <p class="tw-font-medium tw-text-zinc-300">Oct 24, 04:04 PM</p>
                  </div>
                </div>
                <div class="tw-flex tw-items-center tw-gap-2 tw-pt-4 tw-border-t tw-border-border">
                  <button class="tw-text-xs tw-font-medium tw-px-3 tw-py-1.5 tw-text-zinc-300 tw-bg-surface tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-1.5">
                    <span class="material-symbols-outlined tw-text-sm">play_arrow</span> Start
                  </button>
                  <button class="tw-text-xs tw-font-medium tw-px-3 tw-py-1.5 tw-text-zinc-300 tw-bg-surface tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-1.5">
                    <span class="material-symbols-outlined tw-text-sm">stop</span> Stop
                  </button>
                  <button class="tw-text-xs tw-font-medium tw-px-3 tw-py-1.5 tw-text-zinc-300 tw-bg-surface tw-hover:bg-zinc-700 tw-flex tw-items-center tw-gap-1.5">
                    <span class="material-symbols-outlined tw-text-sm">restart_alt</span> Restart
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="tw-bg-primary/10 tw-p-6 tw-border tw-border-primary/20">
            <h3 class="tw-font-semibold tw-text-primary tw-flex tw-items-center tw-gap-2 tw-mb-2">
              HOW IT WORKS
              <span class="material-symbols-outlined tw-text-base">info</span>
            </h3>
            <p class="tw-text-sm tw-text-primary/80">
              Each added mailbox has an IMAP watcher that monitors INBOX in real time. The watcher moves new mail to Quarantine for review. The SMTP proxy accepts incoming messages locally for interception and auditing. Use the controls above to start, stop, or restart watchers.
            </p>
          </div>
        </div>
      </main>
    </div>
  </div>
</div>
{% endblock %}
