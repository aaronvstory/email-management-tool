/*
 * DASHBOARD BUG FIXES
 * Created: 2025-10-25
 * Purpose: Fix all layout bugs identified in dashboard
 * Apply these fixes to main.css when porting to live site
 */

/* ========================================================================
   BUG-001: Search Bar - Icon Overlapping Text
   ======================================================================== */
.global-search .search-icon {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    font-size: 0.9rem;
    pointer-events: none; /* Prevent click interference */
}

.global-search input[type="search"],
.global-search input[type="text"] {
    width: 100%;
    padding: 8px 14px 8px 44px !important; /* INCREASED from 40px to 44px */
    height: 38px;
    border-radius: 999px;
    background: rgba(255,255,255,0.06);
    border: 1px solid var(--border-emphasis);
    color: var(--text-primary);
    font-size: 0.875rem; /* Slightly smaller for better fit */
    letter-spacing: 0.01em;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

/* ========================================================================
   BUG-002: Sidebar "Dashboard" Link Cut Off by Header
   ======================================================================== */
.sidebar-modern {
    width: 250px;
    background: rgba(26,26,26,0.96);
    border-right: 1px solid var(--color-border);
    padding: 20px 14px 16px;
    display: flex;
    flex-direction: column;
    gap: 18px;
    position: fixed; /* Fixed position */
    top: 0;
    left: 0;
    bottom: 0;
    z-index: 50; /* Below command bar (z-index: 100) */
}

.sidebar-modern nav {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
    padding-top: 72px !important; /* ADDED: Account for fixed command bar height */
    overflow-y: auto; /* Allow scrolling if content exceeds */
}

/* Ensure brand stays at top */
.sidebar-modern .brand {
    position: sticky;
    top: 0;
    background: rgba(26,26,26,0.96);
    z-index: 10;
    padding-bottom: 12px;
}

/* ========================================================================
   BUG-003: Inconsistent "Dashboard" Button Styling
   ======================================================================== */
.command-nav .command-link,
.brand-chip {
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 8px 16px;
    border-radius: 8px !important; /* CHANGED from 999px to 8px */
    font-size: 0.875rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.command-nav .command-link.active {
    background: rgba(127, 29, 29, 0.15);
    color: var(--text-primary);
    border-radius: 8px !important; /* CONSISTENT rectangular styling */
}

.command-nav .command-link:hover {
    background: rgba(255, 255, 255, 0.06);
    color: var(--text-primary);
}

/* ========================================================================
   BUG-004: SEARCH/CLEAR Buttons - Zero Spacing
   ======================================================================== */
.email-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 16px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border-default, rgba(255, 255, 255, 0.12));
}

.email-toolbar .toolbar-actions {
    display: flex;
    align-items: center;
    gap: 12px !important; /* ADDED: Ensure spacing between buttons */
    margin-left: auto;
}

.email-toolbar .toolbar-actions .btn {
    margin: 0 !important; /* Remove any conflicting margins */
}

/* Alternative: Direct button spacing if above doesn't work */
.toolbar-actions button:not(:last-child) {
    margin-right: 12px !important; /* FALLBACK: Ensure spacing */
}

/* ========================================================================
   BUG-005: Additional Alignment & Spacing Fixes
   ======================================================================== */

/* Ensure all buttons have consistent height */
.btn,
.btn-primary,
.btn-secondary,
.btn-ghost {
    height: 38px !important;
    padding: 0 16px !important;
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
    gap: 8px;
    border-radius: 8px !important;
    font-size: 0.875rem;
    font-weight: 600;
    transition: all 0.2s ease;
}

/* Command bar spacing improvements */
.command-bar {
    display: flex;
    align-items: center;
    gap: 16px !important; /* INCREASED from 12px for better breathing room */
    padding: 14px 24px; /* INCREASED horizontal padding */
    margin: 0;
    background: var(--surface-highest);
    border: none;
    border-bottom: 1px solid var(--border-emphasis);
    border-radius: 0;
    box-shadow: none;
    position: fixed;
    top: 0;
    left: 250px; /* Account for sidebar width */
    right: 0;
    height: 66px; /* Explicit height */
    z-index: 100;
    backdrop-filter: blur(8px);
}

/* Command controls spacing */
.command-controls {
    display: flex;
    align-items: center;
    gap: 24px !important; /* Better spacing between search and actions */
    flex: 1;
    justify-content: space-between;
}

/* Command actions - reorganized layout (BUG-006) */
.command-actions {
    display: flex;
    align-items: center;
    gap: 16px !important;
}

/* Separate action buttons from status indicators with visual divider */
.command-actions::before {
    content: '';
    width: 1px;
    height: 32px;
    background: rgba(255, 255, 255, 0.12);
    margin: 0 4px;
}

/* Primary action buttons group (COMPOSE, SETTINGS) */
.command-actions .toolbar-group:first-child {
    display: flex;
    align-items: center;
    gap: 8px !important;
    order: 1; /* Action buttons come first */
}

/* Status indicators group (health pills) */
.command-actions .toolbar-group:last-child {
    display: flex;
    align-items: center;
    gap: 10px !important;
    order: 2; /* Status pills come after divider */
}

/* Health pills spacing and styling */
.toolbar-group {
    display: flex;
    align-items: center;
    gap: 10px !important;
}

.health-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.08);
    color: var(--text-muted);
    transition: all 0.2s ease;
}

.health-pill.ok {
    background: rgba(16, 185, 129, 0.08);
    border-color: rgba(16, 185, 129, 0.15);
    color: #6ee7b7;
}

.health-pill.down {
    background: rgba(252, 165, 165, 0.08);
    border-color: rgba(252, 165, 165, 0.15);
    color: #fca5a5;
}

/* Make action buttons more prominent */
.command-actions .btn-secondary,
.command-actions .btn-ghost {
    font-size: 0.8rem !important;
    height: 36px !important;
    padding: 0 14px !important;
    font-weight: 600 !important;
}

/* Main content area - account for fixed header + sidebar */
.main-modern {
    margin-left: 250px; /* Sidebar width */
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.content-scroll {
    flex: 1;
    overflow-y: auto;
    padding: 100px 36px 28px !important; /* INCREASED from 88px to 100px - fixes page heading cutoff (BUG-005) */
    display: flex;
    flex-direction: column;
    gap: 28px;
}

/* Ensure page headers don't overlap with fixed command bar */
.page-header {
    margin-top: 0 !important;
    padding-top: 0 !important;
    margin-bottom: 24px !important;
}

/* Panel consistency */
#dashboard-page .panel-unified {
    background: var(--surface-highest, #242424);
    border: 1px solid var(--border-subtle, rgba(255, 255, 255, 0.06));
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.4);
    margin-bottom: 24px;
}

/* Status tabs - ensure proper spacing */
#dashboard-page .status-tabs-unified {
    display: flex;
    flex-wrap: wrap;
    gap: 10px !important; /* INCREASED from 8px */
    margin-bottom: 20px !important; /* Better separation */
}

#dashboard-page .status-tabs-unified .status-tab {
    background: transparent;
    border: 1px solid var(--border-default, rgba(255, 255, 255, 0.12));
    color: var(--text-muted, #9ca3af);
    border-radius: 8px;
    padding: 10px 18px !important; /* INCREASED padding for better clickability */
    font-size: 0.875rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

/* Form controls consistency */
.form-control,
.form-select {
    height: 38px !important; /* Match button height */
    padding: 8px 14px !important;
    background: rgba(255, 255, 255, 0.06) !important;
    border: 1px solid var(--border-default) !important;
    border-radius: 8px !important;
    color: var(--text-primary) !important;
    font-size: 0.875rem;
}

/* Typography improvements */
h1, h2, h3, h4, h5, h6 {
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.3;
}

.page-header h1 {
    font-size: 1.75rem;
    margin-bottom: 4px;
}

.panel-unified-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--text-primary, #ffffff);
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Ensure proper text hierarchy */
.text-muted {
    color: var(--text-muted, #9ca3af) !important;
}

.text-primary {
    color: var(--text-primary, #ffffff) !important;
}

/* ========================================================================
   RESPONSIVE FIXES
   ======================================================================== */

@media (max-width: 1200px) {
    .sidebar-modern {
        width: 220px;
    }

    .command-bar {
        left: 220px;
    }

    .main-modern {
        margin-left: 220px;
    }
}

@media (max-width: 992px) {
    .sidebar-modern {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        width: 250px;
        left: 0;
    }

    .sidebar-modern.open {
        transform: translateX(0);
    }

    .command-bar {
        left: 0 !important;
    }

    .main-modern {
        margin-left: 0 !important;
    }

    .command-bar .toggle-nav {
        display: inline-flex !important;
    }
}
